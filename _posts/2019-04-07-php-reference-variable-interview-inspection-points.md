---
title: PHP引用变量
date: 2019-04-07
categories: php
tags:
- php
- 引用变量
---

在php的基础里，引用变量是一个重要的只是点。这里将详细介绍引用变量。

<!-- more -->

# 引用变量的概念

使用不同的名字访问同一个变量内存


# 引用变量的定义方式

在变量前加 & 符号

# 工作原理
COW 机制 copy on write

## 先不使用引用变量
```shell
 $a = range(0,5); 
 $b = $a;
```
将a变量值赋给b变量，这样触发COW机制，a b两个变量指向一个内存空间。

```shell
$b = range(1,6);
``` 
 当改变b变量的值时，这样触发COW机制，会生成 b 的内存空间，a b两个变量拥有各自的内存空间。

## 使用引用变量

```shell
$b = &$a; 
$b = range(1,6);
```
这样不会触发COW机制，引用赋值两个变量共享一个内存空间，修改的共享空间内容。

# 经典案例
写出下列程序每次循环的结果

```shell
<?php

$data=["a", "b", "c"];

foreach($data as $k=>$v)
{
	$v = &$data[$k];
}

```
第一次循环
```shell
$k=0;
$v=a;
$v=&$data[0];

$v和$data[0] 变量指向同一内存地址
```
第一次循环的结果：["a", "b", "c"]

第二次循环时
```shell
$v被赋值为b，对于在同一内存地址的$data[0]也变为b

$k=1;
$v=b;
$v=&$data[1];

```

第二次循环的结果：["b", "b", "c"]

同理,
```shell
第三次循环$data[1]也变为c

$k=2;
$v=c;
$v=&$data[2];

```
第三次循环的结果：["b", "c", "c"]
